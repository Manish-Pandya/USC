<div class="full bio-safety-cabinets-container" style="padding:5px;" ng-show="cabinets.length && completeCabinets.length || selectedBuilding || filter.pi || filter.status">
    <h2 ng-if="!uncertified">{{selectedCertificationDate || 'All'}} Certification Records -- {{campus.Name}}</h2>
    <h2 ng-if="uncertified">Uncertified Cabinets</h2>

    <table class="table table-striped table-bordered">
        <tr class="table-header">
            <th>EDIT</th>
            <th>TYPE</th>
            <th>SERIAL #</th>
            <th>MAKE</th>
            <th>MODEL</th>
            <th>
                <ul>
                    <li>
                        BUILDING<br>
                        <input ng-model="selectedBuilding" style="width:150px;" placeholder="Filter by Building" />
                    </li>
                    <li>
                        ROOM
                    </li>
                    <li>
                        CERT-DATE
                    </li>
                    <li>
                        DUE-DATE
                    </li>
                    <li ng-init="filter">
                        INVESTIGATOR
                        <input ng-model="filter.pi" style="width:150px;" placeholder="Filter by PI" />
                    </li>
                    <li>
                        STATUS
                        <input ng-model="filter.status" style="width:100%;" placeholder="Filter by Status" />
                    </li>
                    <li>
                        REPORT
                    </li>
                    <li>
                        COMMENTS
                    </li>
                </ul>
            </th>
        </tr>

        <!-- the following filter grabs cabinet inspections that have a Certification_date, stripping those with no Certification_date set: matchEquipmentDate:'':'Certification_date' -->
        <tr ng-repeat="cabinet in completeCabinets = (cabinets | pi:filter.pi | status:filter.status | matchEquipmentBuilding:selectedBuilding | cabinetYear:selectedCertificationDate:uncertified | matchEquipmentCampus:campus.Key_id | filter:{Is_active: !showInactive}) track by $index" ng-class="{'inactive':!cabinet.Is_active}">
            <td>
                <button ng-disabled="cabinet.edit" ng-class="{'disabled':cabinet.edit}" ng-click="openModal(cabinet, inspections[0], true)" class="btn btn-primary btn-mini left"><i class="icon-pencil"></i></button>
                <button ng-disabled="cabinet.edit" ng-class="{'disabled':cabinet.edit, 'btn-success':!cabinet.Is_active}" ng-click="deactivate(cabinet)" class="btn btn-danger btn-mini left"><i class="icon-remove" ng-class="{'icon-checkmark':!cabinet.Is_active}"></i></button>
            </td>
            <td>
                {{cabinet.Type}}
            </td>
            <td>
                {{cabinet.Serial_number}}
            </td>
            <td>
                {{cabinet.Make}}
            </td>
            <td>
                {{cabinet.Model}}
            </td>
            <td watch="inspections.length" otherwatch="completeCabinets.length" class="asdful-table-heights">
                <ul ng-repeat="inspection in inspections = (cabinet.EquipmentInspections | cabinetInspectionYear:selectedCertificationDate:uncertified | orderBy:'Due_date':true)">
                    <li>
                        {{inspection.Room.Building.Alias || inspection.Room.Building.Name}}
                    </li>
                    <li>
                        {{inspection.Room.Name}}
                    </li>
                    <li style="text-align:center">
                        <a ng-class="{'btn-success':inspection.Certification_date, 'btn-danger':inspection.Status == 'FAIL','btn-info':inspection.Status != 'FAIL' && !inspection.Certification_date}" ng-click="openModal(cabinet, inspection)" class="btn left"><span ng-if="inspection.Certification_date || inspection.Fail_date">{{inspection.Certification_date || inspection.Fail_date | dateToISO}}</span><i class="icon-calendar-alt-stroke"></i></a>
                    </li>
                    <li>
                        {{inspection.Due_date | dateToISO}}
                    </li>
                    <li>
                        <span ng-repeat="pi in inspection.PrincipalInvestigators">{{pi.User.Name}}<br ng-if="!$last"></span>
                    </li>
                    <li>
                        <span class="bold" ng-class="{'red': inspection.Status == constants.BIOSAFETY_CABINET.STATUS.FAIL || inspection.Status == constants.BIOSAFETY_CABINET.STATUS.OVERDUE,
                                                 'yellow': inspection.Status == constants.BIOSAFETY_CABINET.STATUS.PENDING || inspection.Status == constants.BIOSAFETY_CABINET.STATUS.NEW_BSC,
                                                 'green': inspection.Status == constants.BIOSAFETY_CABINET.STATUS.PASS }">{{inspection.Status}}</span>
                    </li>
                    <li>
                        <div ng-if="inspection.Status == inspection.Status == 'FAIL' || inspection.Status == 'PASS'">
                            <div class="btn-group dropup">
                                <a ng-if="inspection.Report_path" class="btn btn-success" href="../biosafety-committees/protocol-documents/{{inspection.Report_path}}" target="_blank">Report</a>
                                <a ng-if="!inspection.Report_path" class="btn btn-success disabled">Report</a>

                                <a class="btn dropdown-toggle upload-container" click-target="inspection" url-fragment="uploadReportCertDocument">
                                    <span class="icon-upload-4"></span>
                                    <input type="file" name="file" id="file" class="inputfile inputfile-1"/>
                                </a>
                            </div>

                            <div class="btn-group dropup">
                                <a ng-if="inspection.Quote_path" class="btn btn-info" href="../biosafety-committees/protocol-documents/{{inspection.Quote_path}}" target="_blank">Quote</a>
                                <a ng-if="!inspection.Quote_path" class="btn btn-info disabled">Quote</a>

                                <a class="btn dropdown-toggle upload-container" click-target="inspection" url-fragment="uploadReportQuoteDocument">
                                    <span class="icon-upload-4"></span>
                                    <input type="file" name="file" id="file" class="inputfile inputfile-1" />
                                </a>
                            </div>
                        </div>

                    </li>
                    <li>
                        {{inspection.Comment}}
                    </li>
                   
                </ul>
            </td>

        </tr>
    </table>
</div>