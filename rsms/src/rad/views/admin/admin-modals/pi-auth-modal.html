<div class="modal-header" style="padding:0;">
    <h2 style="padding:5px; background:rgb(151, 49, 58); color:white" class="blueBg">Create or edit Authorization</h2>
</div>

<div class="modal-body wide-modal">

    <div class="control-group">
        <label class="control-label" for="inputEmail">Date Used:</label>
        <div class="controls">
            <input ng-model="modalData.PIAuthorizationCopy.Form_Approval_date">
            <span class="help-block" style="">mm/dd/yy</span>
        </div>
    </div>

    <div class="control-group">
        <label class="control-label" for="inputEmail">Amendment Number</label>
        <div class="controls input-append">
            <input ng-model="modalData.PIAuthorizationCopy.Amendment_number" maxlength="35" placeholder="Amendment Number" />
        </div>
    </div>

    <div class="control-group">
        <label class="control-label">Authorization Number</label>
        <div class="controls">
            <input ng-model="modalData.PIAuthorizationCopy.Authorization_number" placeholder="Authorization Number" />
        </div>
    </div>
    <div class="control-group">
        <label class="control-label bold">Rooms</label>
        <div class="controls" ng-repeat="room in modalData.pi.Rooms | orderBy:'Building.Name' track by $index">
            <label class="checkbox">
                <input type="checkbox" ng-init="room.isAuthorized = roomIsAuthorized(room, modalData.PIAuthorizationCopy)" ng-model="room.isAuthorized" ng-change="checkboxChange(room, modalData.PIAuthorizationCopy)" />
                <span class="metro-checkbox">{{room.Building_name}} room: {{room.Name}}</span>
            </label>
        </div>
    </div>
    <div class="control-group">
        <label class="control-label bold">Departments</label>
        <div class="controls">
            <label class="checkbox" ng-repeat="department in modalData.pi.Departments">
                <input type="checkbox" ng-init="department.isAuthorized = departmentIsAuthorized(department, modalData.PIAuthorizationCopy)" ng-model="department.isAuthorized" ng-change="checkboxChange(department, modalData.PIAuthorizationCopy)" />
                <span class="metro-checkbox">{{department.Name}}</span>
            </label>
        </div>
    </div>
    <div class="fake-table striped bordered" ng-if="modalData.PIAuthorizationCopy.Authorizations.length && modalData.isAmendment">
        <div class="table-header">
            <h3>Edit</h3>
            <h3>Isotope</h3>
            <h3>Half Life</h3>
            <h3>Emitter Type</h3>
            <h3>Maximum Quantity</h3>
            <h3>Approval Date</h3>
            <h3>Revocation Date</h3>
            <h3>Form</h3>
        </div>
        <div class="table-row" ng-repeat="auth in modalData.PIAuthorizationCopy.Authorizations" ng-class="{'inactive':!auth.Is_active}">
            <div>
                <a class="btn btn-primary" ng-click="openModal('views/admin/admin-modals/authorization-modal', auth)"><i class="icon-pencil"></i></a>
                <a ng-if="auth.Is_active" ng-click="af.setObjectActiveState(auth)" class="btn btn-danger"><i class="icon-remove"></i></a>
                <a ng-if="!auth.Is_active" ng-click="af.setObjectActiveState(auth)" class="btn btn-success"><i class="icon-checkmark"></i></a>
            </div>

            <div>
                <div class="control-group">
                    <label class="control-label">Isotope</label>
                    <div class="controls">
                        <select data-ng-change="selectIsotope()" data-ng-options="isotope.Key_id as isotope.Name for isotope in isotopes" data-ng-model="auth.Isotope_id">
                            <option style="display:none" value="">Select an Isotope</option>
                        </select>
                    </div>
                </div>
            </div>

            <div>
                {{auth.Isotope.Display_half_life}} {{auth.Isotope.Unit}}
            </div>

            <div>
                {{auth.Isotope.Emitter_type}}
            </div>

            <div>
                <div class="control-group">
                    <label class="control-label" for="inputEmail">Maximum Quantity</label>
                    <div class="controls input-append">
                        <input data-ng-model="auth.Max_quantity" placeholder="Maximum Quantity" /><span class="add-on">mCi</span>
                    </div>
                </div>
            </div>

            <div>
                {{modalData.PIAuthorizationCopy.Form_Approval_date}}
            </div>

            <div>
                {{auth.Revocation_date | dateToISO}}
            </div>

            <div>
                <div class="control-group">
                    <label class="control-label" for="inputEmail">Form</label>
                    <div class="controls input-append">
                        <input data-ng-model="auth.Form" maxlength="35" placeholder="Form" />
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

</div>

<div class="modal-footer">
    <a class="btn btn-large btn-success left" ng-click="savePIAuthorization( modalData.PIAuthorizationCopy, modalData.PIAuthorization )"><i class="icon-checkmark"></i>Save</a>
    <a class="btn btn-large btn-danger left" ng-click="close()"><i class="icon-cancel-2"></i>Close</a>
</div>
