<!--div cg-busy="{promise:CarboyReadingAmountSaving, message:'Saving', backdrop:true,templateUrl:'views/busy-templates/full-page-busy.html'}"></div-->
<div cg-busy="{promise:loading, message:'loading', backdrop:true,templateUrl:'views/busy-templates/full-page-busy.html'}"></div>

<div class="right-column">
    <div class="well two-thirds">
        <h1 class="transfers"><i class="icon-tab"></i>Transfers<a ng-click="openModal()" class="btn btn-success left" style="margin-left:10px"><i class="icon-plus-2"></i><i class="icon-carboy"></i>New Transfer</a></h1>
        <div class="card full transfers">
            <h3 ng-show="!transfersIn.length > 0"><i class="icon-tab"></i>No Transfers from other institutions</h3>
            <div class="fake-table bordered" ng-show="transfersIn.length > 0">
                <div class="table-header">
                    <h3>Edit {{transfersBetween.length}}</h3>
                </div>
                <div class="table-row" ng-repeat="transfer in transfersIn = (parcels | transferInParcels)">
                    <div>
                        <a ng-disabled="carboy.edit" ng-class="{'disabled':carboy.edit}" ng-click="openModal(carboy)" class="btn btn-primary left"><i class="icon-pencil"></i>Edit</a>
                        <!-- TODO: Possible Status values should be enums -->
                        <a ng-disabled="carboy.edit" ng-if="carboy.Current_carboy_use_cycle.Status != 'In Use' && carboy.Current_carboy_use_cycle.Status != 'Decaying'" ng-class="{'disabled':carboy.edit}" ng-click="deactivate(carboy)" class="btn btn-danger left"><i class="icon-remove"></i>Deactivate</a>
                    </div>
                    
                </div>
            </div>
        </div>

        <div class="card full transfers">
            <h3 ng-show="!transfersBetween.length > 0"><i class="icon-tab"></i>No Transfers from Between Pis</h3>
            <div class="fake-table bordered" ng-show="transfersBetween.length > 0">
                <div class="table-header">
                    <h3>Edit</h3>
                    <h3>Carboy Number</h3>
                    <h3>Status</h3>
                    <h3>PI</h3>
                </div>
                <div class="table-row" ng-repeat="transfer in transfersBetween = (parcels | transferBetweenParcels)">
                    <div>
                        <a ng-disabled="carboy.edit" ng-class="{'disabled':carboy.edit}" ng-click="openModal(carboy)" class="btn btn-primary left"><i class="icon-pencil"></i>Edit</a>
                        <!-- TODO: Possible Status values should be enums -->
                        <a ng-disabled="carboy.edit" ng-if="carboy.Current_carboy_use_cycle.Status != 'In Use' && carboy.Current_carboy_use_cycle.Status != 'Decaying'" ng-class="{'disabled':carboy.edit}" ng-click="deactivate(carboy)" class="btn btn-danger left"><i class="icon-remove"></i>Deactivate</a>
                    </div>
                    <div>
                        {{carboy.Carboy_number}}
                    </div>
                    <div>
                        {{carboy.Current_carboy_use_cycle.Status}}
                    </div>
                    <div ng-init="carboy.Current_carboy_use_cycle.loadPrincipalInvestigator()">
                        {{carboy.Current_carboy_use_cycle.Principal_investigator.User.Name}}
                    </div>
                </div>
            </div>
        </div>

        <div class="card full transfers">
            <h3 ng-show="!transfersOut.length"><i class="icon-tab"></i>No Transfers to other institutions</h3>
            <div class="fake-table bordered" ng-show="transfersOut.length">
                <div class="table-header">
                    <h3>Edit</h3>
                    <h3>Carboy Number</h3>
                    <h3>Status</h3>
                    <h3>PI</h3>
                </div>
                <div class="table-row" ng-repeat="transfer in transfersOut = (uses | transferOutUses)">
                    <div>
                        <a ng-disabled="carboy.edit" ng-class="{'disabled':carboy.edit}" ng-click="openModal(carboy)" class="btn btn-primary left"><i class="icon-pencil"></i>Edit</a>
                        <!-- TODO: Possible Status values should be enums -->
                        <a ng-disabled="carboy.edit" ng-if="carboy.Current_carboy_use_cycle.Status != 'In Use' && carboy.Current_carboy_use_cycle.Status != 'Decaying'" ng-class="{'disabled':carboy.edit}" ng-click="deactivate(carboy)" class="btn btn-danger left"><i class="icon-remove"></i>Deactivate</a>
                    </div>
                    <div>
                        {{carboy.Carboy_number}}
                    </div>
                    <div>
                        {{carboy.Current_carboy_use_cycle.Status}}
                    </div>
                    <div ng-init="carboy.Current_carboy_use_cycle.loadPrincipalInvestigator()">
                        {{carboy.Current_carboy_use_cycle.Principal_investigator.User.Name}}
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>
